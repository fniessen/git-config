#+TITLE:     Git configuration file
#+AUTHOR:    Fabrice Niessen
#+EMAIL:     (concat "fniessen" at-sign "pirilampo.org")
#+Time-stamp: <2014-02-03 Mon 15:34>
#+DESCRIPTION:
#+KEYWORDS:
#+LANGUAGE:  en

#+PROPERTY:  tangle src/.gitconfig

* User

#+begin_src conf
[user]
	name = Fabrice Niessen
	email = fniessen@pirilampo.org
#+end_src

* Core

#+begin_src conf
[core]
	editor = emacsclient
	pager = less
	whitespace = fix,-indent-with-non-tab,trailing-space,cr-at-eol
#+end_src

* Color

#+begin_src conf
[color]
	ui = auto
	branch = auto
	diff = auto
	status = auto
	interactive = auto
#+end_src

** Branch

#+begin_src conf
[color "branch"]
	current = yellow reverse
	local = yellow
	remote = green
#+end_src

** Diff

#+begin_src conf
[color "diff"]
	meta = yellow bold
	frag = magenta bold
	old = red bold
	new = green bold
	whitespace = red reverse
#+end_src

** Status

#+begin_src conf
[color "status"]
	added = yellow
	changed = green
	untracked = cyan
#+end_src

** Grep

#+begin_src conf
[color "grep"]
	filename = bold yellow reverse
	linenumber = magenta bold
	match = green reverse bold
	separator = red bold
	selected = white bold
	context = black
	function = red
#+end_src

* Alias

Common shortcuts:

#+begin_src conf
[alias]
	st = status
	ci = commit
	br = branch
	co = checkout
	df = diff
	lg = log -p
#+end_src

#+begin_src conf
[alias]
	lgr = log --decorate --pretty=format:'%C(yellow)%h%Creset %C(bold cyan)%d%Creset %s %Cgreen<%an> %C(bold blue)(%cd)%Creset' --abbrev-commit --date=relative --graph
	lga = log --decorate --pretty=format:'%C(yellow)%h%Creset %C(bold cyan)%d%Creset %s %Cgreen<%an> %C(bold blue)(%cd)%Creset' --abbrev-commit --date=short --graph
	y = diff "@{yesterday}"
	w = whatchanged
	who = shortlog -s --
	dc = diff --cached
	ls = ls-files

	# Show files ignored by git:
	ign = ls-files -o -i --exclude-standard
#+end_src

** Cherrypick style recording

Ask interactively which patch hunk to commit, and then do the commit:

#+begin_src conf
[alias]
	record = ! sh -c '(git add -p -- $@ && git commit) || git reset' --
#+end_src

It will not only do =git add -p= (with an optional file list), but it will also
immediately do the =commit=. Upon abandonment of either the add or the commit it
will =reset= the index.

**  Getting the diff of a branch since it forked from another branch, or since the last merge

To see the changes in a branch since it was forked from another branch, or
since the last merge with the origin branch, you can add this alias:

#+begin_src conf
[alias]
	forkdiff = !bash -c 'git diff $(git merge-base "$1" "$2") "$2" "${@: 3}" ' -
#+end_src

It uses =git merge-base= to determine the fork-point (the commit that is common
to both the branches) and does a =git diff= between that commit and the second
branch.

Usage

: git forkdiff <forked from branch> <forked branch> [git-diff-options]

Example

: git forkdiff origin/master my_forked_branch --stat

* Push

#+begin_src conf
[push]
	# default = simple # default for Git 1.8.0+
	default = matching
#+end_src

* Install environment
  :PROPERTIES:
  :tangle:   src/install-gitconfig-file
  :END:

Symlink the files.

#+begin_src sh :results silent :padline no :shebang #!/bin/bash
ln -f -s $(pwd)/.gitconfig ~/.gitconfig
#+end_src

* References

- [[https://git.wiki.kernel.org/index.php/Aliases][Git SCM Wiki - Aliases]]
